#!/bin/bash -eux
#
#MSUB -N vpic-baseline
#MSUB -l walltime=0:40:00
#MSUB -l nodes=1:haswell
#MSUB -o /users/$USER/joblogs/vpic-baseline-$MOAB_JOBID.out
#MSUB -j oe
#DW jobdw access_mode=striped capacity=25GiB type=scratch
ip_subnet="11.128"
cores_per_node=32
export JOBDIRHOME="/lustre/ttscratch1/users/$USER"
export EXTRA_MPIOPTS="--cc cpu"

#|   VPIC baseline | Run 1 | Run 2 | Run 3 | Run 4 |#
#|----------------:|:-----:|:-----:|:-----:|:-----:|#
#|           nodes |   1   |   4   |   16  |   64  |#
#|  num_vpic_dumps |   8   |   8   |   8   |   8   |#
#|       px_factor |   16  |   16  |   16  |   16  |#
#|       py_factor |   4   |   4   |   4   |   4   |#
#|   num_particles |  512M |   2G  |   8G  |  32G  |#

############
# RUN CONF
# -----
nodes=1
num_vpic_dumps=2
px_factor=4
py_factor=2

@CMAKE_INSTALL_PREFIX@/scripts/run_vpic_baseline.sh \
    $ip_subnet \
    $nodes \
    $cores_per_node \
    $cores_per_node \
    $cores_per_node \
    $num_vpic_dumps \
    $px_factor \
    $py_factor

exit 0
